# دليل سريع: الطباعة الجماعية للفواتير

## 🚀 كيفية الاستخدام

### خطوات بسيطة:

1. **افتح صفحة الطلبات**
   ```
   لوحة التحكم → الطلبات
   ```

2. **حدد الطلبات المراد طباعة فواتيرها**
   ```
   ✓ الطلب #1
   ✓ الطلب #2
   ✓ الطلب #3
   ```

3. **اضغط "إجراءات جماعية"**
   ```
   زر في أعلى الصفحة يظهر عند تحديد طلبات
   ```

4. **اختر "طباعة الفواتير"**
   ```
   من قائمة الإجراءات المتاحة
   ```

5. **اضغط "تنفيذ الإجراء"**
   ```
   ستفتح نافذة جديدة مع جميع الفواتير
   ```

6. **اضغط "طباعة الكل"**
   ```
   كل فاتورة ستُطبع في ورقة منفصلة
   ```

---

## 📁 الملفات المُضافة

### 1. صفحة الطباعة الجماعية
```
/front-end/src/pages/admin/InvoiceBulkPrint.tsx
```
- تعرض جميع الفواتير المحددة
- زر واحد لطباعة الكل
- كل فاتورة في صفحة منفصلة

---

## 🔧 الملفات المُعدلة

### 1. App.tsx
```tsx
// إضافة Route جديد
<Route path="orders/bulk-invoice" element={<InvoiceBulkPrint />} />
```

### 2. OrderBulkActions.tsx
```tsx
// إضافة خيار "طباعة الفواتير"
{
  id: 'print_invoices',
  label: 'طباعة الفواتير',
  icon: Printer,
}
```

### 3. AdminOrders.tsx
```tsx
// معالجة action الطباعة
if (action === 'print_invoices') {
  const orderNumbers = selectedOrders.map(o => o.order_number).join(',');
  window.open(`/admin/orders/bulk-invoice?ids=${orderNumbers}`);
}
```

---

## ✨ المميزات الرئيسية

### ✅ فصل تلقائي للصفحات
```css
.invoice-page {
  page-break-after: always; /* كل فاتورة في صفحة */
}
```

### ✅ طباعة نظيفة
```css
@media print {
  /* فقط الفواتير تُطبع، بدون أزرار أو عناصر أخرى */
  .no-print { display: none; }
}
```

### ✅ عرض جيد على الشاشة
```css
@media screen {
  /* كل فاتورة في بطاقة مع ظل */
  .invoice-page {
    box-shadow: 0 0 10px rgba(0,0,0,0.1);
    margin-bottom: 40px;
  }
}
```

---

## 🎯 مثال عملي

### السيناريو:
```
لديك 5 طلبات جديدة تريد طباعة فواتيرها معاً
```

### الخطوات:
1. حدد الطلبات الخمسة ✓
2. إجراءات جماعية → طباعة الفواتير
3. تفتح نافذة بـ 5 فواتير
4. طباعة الكل → 5 صفحات

### النتيجة:
```
✓ صفحة 1: فاتورة الطلب #1
✓ صفحة 2: فاتورة الطلب #2
✓ صفحة 3: فاتورة الطلب #3
✓ صفحة 4: فاتورة الطلب #4
✓ صفحة 5: فاتورة الطلب #5
```

---

## 🔍 تدفق البيانات المبسط

```
1. المستخدم يحدد طلبات: [1, 2, 3]
   ↓
2. يضغط "طباعة الفواتير"
   ↓
3. النظام يجمع order_numbers: ["ORD-001", "ORD-002", "ORD-003"]
   ↓
4. يفتح: /bulk-invoice?ids=ORD-001,ORD-002,ORD-003
   ↓
5. تحميل بيانات الطلبات من API
   ↓
6. عرض جميع الفواتير
   ↓
7. المستخدم يطبع → كل فاتورة في صفحة
```

---

## 🎨 الشكل النهائي

### على الشاشة:
```
┌─────────────────────────────────────┐
│ [←] العودة    {3} فاتورة  [🖨] طباعة │
├─────────────────────────────────────┤
│                                     │
│  📄 فاتورة ORD-001                  │
│  [تفاصيل كاملة مع منتجات]           │
│                                     │
│  📄 فاتورة ORD-002                  │
│  [تفاصيل كاملة مع منتجات]           │
│                                     │
│  📄 فاتورة ORD-003                  │
│  [تفاصيل كاملة مع منتجات]           │
│                                     │
└─────────────────────────────────────┘
```

### عند الطباعة:
```
📄 Page 1: ORD-001
📄 Page 2: ORD-002
📄 Page 3: ORD-003
```

---

## ⚡ نصائح سريعة

### ✅ الأفضل:
- طباعة 1-10 فواتير معاً
- استخدام طابعة PDF للحفظ
- التحقق من المعاينة قبل الطباعة

### ⚠️ تجنب:
- طباعة أكثر من 20 فاتورة دفعة واحدة (بطيء)
- إغلاق النافذة قبل اكتمال التحميل
- الطباعة بدون معاينة

---

## 🐛 حل المشاكل الشائعة

### المشكلة: "صفحة فارغة"
**الحل:** انتظر حتى يكتمل التحميل (شاشة التحميل)

### المشكلة: "الفواتير لا تنفصل"
**الحل:** تأكد من استخدام متصفح حديث (Chrome, Edge, Safari)

### المشكلة: "بطء شديد"
**الحل:** قلل عدد الفواتير إلى 10 أو أقل

---

## 📞 دعم فني

للمزيد من المعلومات، راجع:
- `BULK_INVOICE_PRINT_FEATURE.md` - دليل مفصل كامل
- `PRINT_ONLY_INVOICE_FIX.md` - معلومات عن CSS الطباعة

---

تاريخ الإنشاء: 24 أكتوبر 2025

